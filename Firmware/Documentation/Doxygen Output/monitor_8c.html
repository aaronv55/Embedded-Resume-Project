<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Embedded Resume Project Code Documentation: Firmware/Embedded Resume Files/monitor.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Favicon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Embedded Resume Project Code Documentation
   &#160;<span id="projectnumber">Version 1.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('monitor_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">monitor.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains functions that monitor various background aspects of the system like battery voltage, headphone and USB sense etc.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="monitor_8h_source.html">monitor.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7fd5b067e8b8ff93e2f35713a4ad7e8a"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor_8c.html#a7fd5b067e8b8ff93e2f35713a4ad7e8a">monitor_adc_to_battery_level</a> (uint16_t current_adc_value)</td></tr>
<tr class="memdesc:a7fd5b067e8b8ff93e2f35713a4ad7e8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remap the raw ADC values 0 - 4095 to a battery percentage of 0 - 100.  <a href="monitor_8c.html#a7fd5b067e8b8ff93e2f35713a4ad7e8a">More...</a><br /></td></tr>
<tr class="separator:a7fd5b067e8b8ff93e2f35713a4ad7e8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0192d47bcf7e2972184a1b782d963caf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor_8c.html#a0192d47bcf7e2972184a1b782d963caf">monitor_usbsense_init</a> (void)</td></tr>
<tr class="memdesc:a0192d47bcf7e2972184a1b782d963caf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize usbsense pin as input.  <a href="monitor_8c.html#a0192d47bcf7e2972184a1b782d963caf">More...</a><br /></td></tr>
<tr class="separator:a0192d47bcf7e2972184a1b782d963caf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38e2c93f1d9834b2455ba6114e0dc570"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor_8c.html#a38e2c93f1d9834b2455ba6114e0dc570">monitor_get_usb_status</a> (void)</td></tr>
<tr class="memdesc:a38e2c93f1d9834b2455ba6114e0dc570"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current state of usbsense.  <a href="monitor_8c.html#a38e2c93f1d9834b2455ba6114e0dc570">More...</a><br /></td></tr>
<tr class="separator:a38e2c93f1d9834b2455ba6114e0dc570"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f610aa3879181249a9e6ae21e62c9fa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor_8c.html#a6f610aa3879181249a9e6ae21e62c9fa">monitor_jacksense_init</a> (void)</td></tr>
<tr class="memdesc:a6f610aa3879181249a9e6ae21e62c9fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize PA3 to trigger an interrupt when headphones are removed or plugged in.  <a href="monitor_8c.html#a6f610aa3879181249a9e6ae21e62c9fa">More...</a><br /></td></tr>
<tr class="separator:a6f610aa3879181249a9e6ae21e62c9fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aceb2f47c814cadc2d2f4b9a237a35beb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor_8c.html#aceb2f47c814cadc2d2f4b9a237a35beb">monitor_batterysense_init</a> (void)</td></tr>
<tr class="memdesc:aceb2f47c814cadc2d2f4b9a237a35beb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the batterysense pin as an analog input.  <a href="monitor_8c.html#aceb2f47c814cadc2d2f4b9a237a35beb">More...</a><br /></td></tr>
<tr class="separator:aceb2f47c814cadc2d2f4b9a237a35beb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacba16329bd1b9c48b65aca560bad2be"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor_8c.html#aacba16329bd1b9c48b65aca560bad2be">monitor_get_battery_level</a> (uint8_t sample_flag)</td></tr>
<tr class="memdesc:aacba16329bd1b9c48b65aca560bad2be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take multiple voltage samples of the battery and return their average.  <a href="monitor_8c.html#aacba16329bd1b9c48b65aca560bad2be">More...</a><br /></td></tr>
<tr class="separator:aacba16329bd1b9c48b65aca560bad2be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3c19da65bae63a81c899416308eafe7"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor_8c.html#ab3c19da65bae63a81c899416308eafe7">monitor_get_raw_battery_level</a> (uint8_t sample_flag)</td></tr>
<tr class="memdesc:ab3c19da65bae63a81c899416308eafe7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take multiple voltage samples of the battery and return their average.  <a href="monitor_8c.html#ab3c19da65bae63a81c899416308eafe7">More...</a><br /></td></tr>
<tr class="separator:ab3c19da65bae63a81c899416308eafe7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52188904ebf2d3c5abcdb45dad9a3f0c"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor_8c.html#a52188904ebf2d3c5abcdb45dad9a3f0c">monitor_get_headphone_status</a> (void)</td></tr>
<tr class="memdesc:a52188904ebf2d3c5abcdb45dad9a3f0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current state of usbsense.  <a href="monitor_8c.html#a52188904ebf2d3c5abcdb45dad9a3f0c">More...</a><br /></td></tr>
<tr class="separator:a52188904ebf2d3c5abcdb45dad9a3f0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea15ecad2430f3629dc9102e17f01c3f"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor_8c.html#aea15ecad2430f3629dc9102e17f01c3f">monitor_get_main_power_button_status</a> (void)</td></tr>
<tr class="memdesc:aea15ecad2430f3629dc9102e17f01c3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current state of the main external user button.  <a href="monitor_8c.html#aea15ecad2430f3629dc9102e17f01c3f">More...</a><br /></td></tr>
<tr class="separator:aea15ecad2430f3629dc9102e17f01c3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a114cb7043c1049501f736666f3d49587"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor_8c.html#a114cb7043c1049501f736666f3d49587">monitor_reset_main_power_button_status</a> (void)</td></tr>
<tr class="memdesc:a114cb7043c1049501f736666f3d49587"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the current state of the main external user button to not clicked.  <a href="monitor_8c.html#a114cb7043c1049501f736666f3d49587">More...</a><br /></td></tr>
<tr class="separator:a114cb7043c1049501f736666f3d49587"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a046e1a4d35c52aea32bc5c5eaa83cb68"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor_8c.html#a046e1a4d35c52aea32bc5c5eaa83cb68">monitor_power_button_init</a> (void)</td></tr>
<tr class="memdesc:a046e1a4d35c52aea32bc5c5eaa83cb68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize external button (the main power button) as an interrupt pin.  <a href="monitor_8c.html#a046e1a4d35c52aea32bc5c5eaa83cb68">More...</a><br /></td></tr>
<tr class="separator:a046e1a4d35c52aea32bc5c5eaa83cb68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97784d68816846e88aebeefd7a6cf205"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor_8c.html#a97784d68816846e88aebeefd7a6cf205">monitor_get_power_press_type</a> (void)</td></tr>
<tr class="memdesc:a97784d68816846e88aebeefd7a6cf205"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if the main power button is clicked shortly or if it is held down.  <a href="monitor_8c.html#a97784d68816846e88aebeefd7a6cf205">More...</a><br /></td></tr>
<tr class="separator:a97784d68816846e88aebeefd7a6cf205"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17e9789a29a87d2df54f12b94dd1a0b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor_8c.html#a17e9789a29a87d2df54f12b94dd1a0b6">EXTI0_IRQHandler</a> (void)</td></tr>
<tr class="memdesc:a17e9789a29a87d2df54f12b94dd1a0b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">ISR that is called when PA0 experiences a rising edge (main power button is pressed)  <a href="monitor_8c.html#a17e9789a29a87d2df54f12b94dd1a0b6">More...</a><br /></td></tr>
<tr class="separator:a17e9789a29a87d2df54f12b94dd1a0b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30c045de96d18ec9c67a7b9e4350920f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor_8c.html#a30c045de96d18ec9c67a7b9e4350920f">EXTI3_IRQHandler</a> (void)</td></tr>
<tr class="memdesc:a30c045de96d18ec9c67a7b9e4350920f"><td class="mdescLeft">&#160;</td><td class="mdescRight">ISR that is called when PA3 experiences a falling or rising edge (headphone is plugged in or taken out)  <a href="monitor_8c.html#a30c045de96d18ec9c67a7b9e4350920f">More...</a><br /></td></tr>
<tr class="separator:a30c045de96d18ec9c67a7b9e4350920f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains functions that monitor various background aspects of the system like battery voltage, headphone and USB sense etc. </p>
<dl class="section author"><dt>Author</dt><dd>Aaron Vorse </dd></dl>
<dl class="section date"><dt>Date</dt><dd>8/15/2020 @contact <a href="#" onclick="location.href='mai'+'lto:'+'aar'+'on'+'.vo'+'rs'+'e@e'+'mb'+'edd'+'ed'+'res'+'um'+'e.c'+'om'; return false;">aaron<span style="display: none;">.nosp@m.</span>.vor<span style="display: none;">.nosp@m.</span>se@em<span style="display: none;">.nosp@m.</span>bedd<span style="display: none;">.nosp@m.</span>edres<span style="display: none;">.nosp@m.</span>ume.<span style="display: none;">.nosp@m.</span>com</a></dd></dl>
<p>@LICENSE:</p>
<p>Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at</p>
<p><a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a17e9789a29a87d2df54f12b94dd1a0b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17e9789a29a87d2df54f12b94dd1a0b6">&#9670;&nbsp;</a></span>EXTI0_IRQHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EXTI0_IRQHandler </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ISR that is called when PA0 experiences a rising edge (main power button is pressed) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">NONE</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NONE </dd></dl>

</div>
</div>
<a id="a30c045de96d18ec9c67a7b9e4350920f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30c045de96d18ec9c67a7b9e4350920f">&#9670;&nbsp;</a></span>EXTI3_IRQHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EXTI3_IRQHandler </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ISR that is called when PA3 experiences a falling or rising edge (headphone is plugged in or taken out) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">NONE</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NONE </dd></dl>

</div>
</div>
<a id="a7fd5b067e8b8ff93e2f35713a4ad7e8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fd5b067e8b8ff93e2f35713a4ad7e8a">&#9670;&nbsp;</a></span>monitor_adc_to_battery_level()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t monitor_adc_to_battery_level </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>current_adc_value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remap the raw ADC values 0 - 4095 to a battery percentage of 0 - 100. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">current_adc_value</td><td>Raw ADC reading </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>tmp_battery_level Converted battery level </dd></dl>

</div>
</div>
<a id="aceb2f47c814cadc2d2f4b9a237a35beb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aceb2f47c814cadc2d2f4b9a237a35beb">&#9670;&nbsp;</a></span>monitor_batterysense_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void monitor_batterysense_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the batterysense pin as an analog input. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">NONE</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NONE </dd></dl>

</div>
</div>
<a id="aacba16329bd1b9c48b65aca560bad2be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacba16329bd1b9c48b65aca560bad2be">&#9670;&nbsp;</a></span>monitor_get_battery_level()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t monitor_get_battery_level </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>sample_flag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Take multiple voltage samples of the battery and return their average. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sample_flag</td><td>Flag used to trigger data sampling only when requested and not every pass of the main loop </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>battery_level</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Make sure the FPU is enabled or this will introduce large amounts of latency </dd></dl>

</div>
</div>
<a id="a52188904ebf2d3c5abcdb45dad9a3f0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52188904ebf2d3c5abcdb45dad9a3f0c">&#9670;&nbsp;</a></span>monitor_get_headphone_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t monitor_get_headphone_status </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the current state of usbsense. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">NONE</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>usb_sense Returns 2 if headphones are plugged in, else 0</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This is added for encapsulation. Other files should not have access to the variable monitor_jacksense_detection which is therefore global only to this file, <a class="el" href="monitor_8c.html" title="This file contains functions that monitor various background aspects of the system like battery volta...">monitor.c</a> </dd></dl>

</div>
</div>
<a id="aea15ecad2430f3629dc9102e17f01c3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea15ecad2430f3629dc9102e17f01c3f">&#9670;&nbsp;</a></span>monitor_get_main_power_button_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t monitor_get_main_power_button_status </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the current state of the main external user button. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">NONE</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>monitor_power_button_detection </dd></dl>

</div>
</div>
<a id="a97784d68816846e88aebeefd7a6cf205"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97784d68816846e88aebeefd7a6cf205">&#9670;&nbsp;</a></span>monitor_get_power_press_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t monitor_get_power_press_type </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine if the main power button is clicked shortly or if it is held down. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">NONE</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>tmp_press_type The type (either SHORT or LONG) of the button press</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>This function locks the system in a loop for roughly 3 seconds. It should only ever be called before entering or leaving a sleep state, so this should not be a problem. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>All other threads (audio, sd card communication) should be killed before calling this. </dd></dl>

</div>
</div>
<a id="ab3c19da65bae63a81c899416308eafe7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3c19da65bae63a81c899416308eafe7">&#9670;&nbsp;</a></span>monitor_get_raw_battery_level()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t monitor_get_raw_battery_level </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>sample_flag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Take multiple voltage samples of the battery and return their average. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sample_flag</td><td>Flag used to sample data only when requested and not every pass of the main loop </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>battery_level </dd></dl>

</div>
</div>
<a id="a38e2c93f1d9834b2455ba6114e0dc570"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38e2c93f1d9834b2455ba6114e0dc570">&#9670;&nbsp;</a></span>monitor_get_usb_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t monitor_get_usb_status </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the current state of usbsense. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">NONE</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>usb_sense Returns 2 if USB charger is plugged in, else 0. Returning 2 for TRUE saves a few instructions by not having to shift the result to the right. </dd></dl>

</div>
</div>
<a id="a6f610aa3879181249a9e6ae21e62c9fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f610aa3879181249a9e6ae21e62c9fa">&#9670;&nbsp;</a></span>monitor_jacksense_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void monitor_jacksense_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize PA3 to trigger an interrupt when headphones are removed or plugged in. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">NONE</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NONE</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Jacksense pin is PA3. Logic low = headphones unplugged Logic high = headphones plugged in </dd></dl>

</div>
</div>
<a id="a046e1a4d35c52aea32bc5c5eaa83cb68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a046e1a4d35c52aea32bc5c5eaa83cb68">&#9670;&nbsp;</a></span>monitor_power_button_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void monitor_power_button_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize external button (the main power button) as an interrupt pin. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">NONE</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NONE </dd></dl>

</div>
</div>
<a id="a114cb7043c1049501f736666f3d49587"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a114cb7043c1049501f736666f3d49587">&#9670;&nbsp;</a></span>monitor_reset_main_power_button_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void monitor_reset_main_power_button_status </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the current state of the main external user button to not clicked. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">NONE</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NONE </dd></dl>

</div>
</div>
<a id="a0192d47bcf7e2972184a1b782d963caf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0192d47bcf7e2972184a1b782d963caf">&#9670;&nbsp;</a></span>monitor_usbsense_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void monitor_usbsense_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize usbsense pin as input. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">NONE</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NONE</dd></dl>
<dl class="section note"><dt>Note</dt><dd>EXTI1 is already used for the touch_sense interrupt generated when the LCD screen is touched. USBsense simply acts as a GPIO input and should be polled in its retaining loop </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_74b6a3b63f61c160c0f14b7a283a4c9b.html">Firmware</a></li><li class="navelem"><a class="el" href="dir_6920784cec34a5f013a34dcb61a8e258.html">Embedded Resume Files</a></li><li class="navelem"><a class="el" href="monitor_8c.html">monitor.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
